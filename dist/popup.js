document.addEventListener("DOMContentLoaded",(function(){const e=document.getElementById("loginContainer"),t=document.getElementById("settingsContainer"),n=document.getElementById("enableOverlay"),o=["facebook","twitter","instagram","linkedin","reddit"],c=document.getElementById("settingsContent"),s=document.getElementById("login"),i=document.getElementById("save");function l(){console.log("Showing login"),e.style.display="block",t.style.display="none"}function a(){console.log("Showing settings"),e.style.display="none",t.style.display="block",chrome.storage.sync.get(["enableOverlay","facebook","twitter","instagram","linkedin","reddit"],(function(e){n.checked=!1!==e.enableOverlay,o.forEach((t=>{document.getElementById(t).checked=!1!==e[t]})),d(),r(e)}))}function r(e){chrome.tabs.query({active:!0,currentWindow:!0},(function(t){t[0]?chrome.tabs.sendMessage(t[0].id,{action:"updateSettings",settings:e},(function(n){chrome.runtime.lastError?(console.log("Content script not found in tab. Injecting content script."),chrome.scripting.executeScript({target:{tabId:t[0].id},files:["social-content.js"]},(()=>{chrome.tabs.sendMessage(t[0].id,{action:"updateSettings",settings:e},(e=>{chrome.runtime.lastError?console.error("Error after injecting content script:",chrome.runtime.lastError.message):console.log("Settings updated in content script after injection")}))}))):console.log("Settings updated in content script")})):console.log("No active tab found")}))}function d(){const e=n.checked;e?c.classList.remove("disabled-section"):c.classList.add("disabled-section"),o.forEach((t=>{document.getElementById(t).disabled=!e}))}console.log("Popup script loaded"),chrome.storage.local.get(null,(function(e){console.log("All stored data (from popup):",JSON.stringify(e,null,2))})),new Promise((e=>{chrome.storage.local.get(["authToken"],(function(t){console.log("Auth token check result:",t),e(!!t.authToken)}))})).then((e=>{console.log("Authentication check result:",e),e?a():l()})),s?s.addEventListener("click",(function(){console.log("Login button clicked"),chrome.runtime.sendMessage({action:"initiateAuthentication"}),window.close()})):console.error("Login button not found"),n?n.addEventListener("change",d):console.error("Enable overlay toggle not found"),i?i.addEventListener("click",(function(){console.log("Save settings button clicked");const e={enableOverlay:n.checked};o.forEach((t=>{const n=document.getElementById(t);e[t]=n.checked})),chrome.storage.sync.set(e,(function(){console.log("Settings saved"),i.textContent="Saved!",i.classList.add("success"),setTimeout((()=>{i.textContent="Save Settings",i.classList.remove("success")}),2e3),r(e)}))})):console.error("Save button not found"),chrome.storage.onChanged.addListener((function(e,t){"local"===t&&e.authToken&&(e.authToken.newValue?a():l())}))}));
//# sourceMappingURL=popup.js.map